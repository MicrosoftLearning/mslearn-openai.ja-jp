---
lab:
  title: Azure OpenAI で作業を開始する
---

# Azure OpenAI Service で作業を開始する

Azure OpenAI Service は OpenAI によって開発された生成 AI モデルを Azure プラットフォームに導入します。これにより、Azure クラウド プラットフォームによって提供されるサービスのセキュリティ、スケーラビリティ、統合の恩恵を受ける強力な AI ソリューションを開発できるようになります。 この演習では、サービスを Azure リソースとしてプロビジョニングし、Azure OpenAI Studio を使用して OpenAI モデルをデプロイおよび探索することで、Azure OpenAI の使用を開始する方法について学習します。

この演習は約 **30** 分かかります。

## 開始する前に

Azure OpenAI サービスへのアクセスが承認されている Azure サブスクリプションが必要になります。

- 無料の Azure サブスクリプションにサインアップするには、[https://azure.microsoft.com/free](https://azure.microsoft.com/free) にアクセスしてください。
- Azure OpenAI サービスへのアクセスを要求するには、[https://aka.ms/oaiapply](https://aka.ms/oaiapply) にアクセスしてください。

## Azure OpenAI リソースをプロビジョニングする

Azure OpenAI モデルを使用する前に、Azure サブスクリプションに Azure OpenAI リソースをプロビジョニングする必要があります。

1. [Azure Portal](https://portal.azure.com) にサインインします。
2. 次の設定で **Azure OpenAI** リソースを作成します。
    - **[サブスクリプション]** : Azure OpenAI サービスへのアクセスが承認されている Azure サブスクリプション。
    - **リソース グループ**: ご自分で選択した名前を持つ新しいリソース グループを作成します。
    - **[リージョン]** : 使用できるリージョンを選択します。
    - **[名前]** : 希望する一意の名前。
    - **価格レベル**: Standard S0
3. デプロイが完了するまで待ちます。 次に、Azure portal でデプロイされた Azure OpenAI リソースに移動します。

## モデルをデプロイする

Azure OpenAI には、モデルのデプロイ、管理、探索に使用できる **Azure OpenAI Studio** という名前の Web ベースのポータルが用意されています。 Azure OpenAI Studio を使用してモデルをデプロイすることで、Azure OpenAI の探索を開始します。

1. Azure OpenAI リソースの **[概要]** ページで、 **[探索]** ボタンを使用して、新しいブラウザー タブで Azure OpenAI Studio を開きます。
2. Azure OpenAI Studio で、新しいデプロイを次の設定で作成します。
    - **[モデル名]** : text-davinci-003
    - **[デプロイ名]** : text-davinci

> **注**: Azure OpenAI には複数のモデルが含まれており、それぞれが機能とパフォーマンスの異なるバランスに合わせて最適化されています。 この演習では、**GPT-3** ファミリのテキスト生成モデルの **Davinci** モデルから始めます。 **text-davinci-003** は、自然言語を要約して生成するために適した一般的なモデルです。 Azure OpenAI で使用可能なモデルの詳細については、Azure OpenAI ドキュメントの[モデル](https://learn.microsoft.com/azure/cognitive-services/openai/concepts/models)に関する記事を参照してください。

## 入力候補のプレイグラウンドでモデルを探索する

"プレイグラウンド" は、Azure OpenAI Studio の便利なインターフェイスであり、独自のクライアント アプリケーションを開発することなく、デプロイされるモデルを実験するために使用できます。**

1. Azure OpenAI Studio の左ペインの **[プレイグラウンド]** で、 **[入力候補]** を選択します。
2. **[入力候補]** ページで、**text-davinci** デプロイが選択されていることを確認し、 **[例]** の一覧で **[Summarize an article (abstractive)] (記事の要約 (アブストラクト))** を選択します。

    テキストの要約のサンプルは、"次のテキストの概要を提供してください..." の行で始まるテキストを提供する "プロンプト" で構成されています。この文でプロンプトを開始すると、以降のテキスト ブロックを要約するようにモデルに指示されます。******

3. ページの下部の、テキストで検出された "トークン" の数をメモします。** トークンは、プロンプトの基本的な単位です。基本的には、テキスト内の単語または単語の一部です。
4. **[生成]** ボタンを使用して、プロンプトをモデルに送信し、応答を取得します。

    応答は、元のテキストの概要で構成されます。 概要は、一般的な言葉で元のテキストの要点を伝える必要があります。

5. **[再生成]** ボタンを使用してプロンプトを再送信します。応答が元のものとは異なる場合があります。 生成 AI モデルは、呼び出されるたびに新しい言葉を生成できます。
6. 要約された応答の下に新しい行を追加し、次のテキストを入力します。

    *AI はどのように進化しましたか?*

7. **[生成]** ボタンを使用して新しいプロンプトを送信し、応答を確認します。 前のプロンプトと応答は、モデルとの会話を進めながらコンテキストを提供するため、モデルが質問に対する適切な回答を生成することができます。
8. プロンプトの内容全体を次のテキストに置き換えます。

    *以下のテキストの主題を捉えた概要を提供してください。* 
    
    *Azure OpenAI Service は、GPT-4、Codex、Embeddings モデル シリーズなどの OpenAI の強力な言語モデルに REST API アクセスを提供します。これらのモデルは、コンテンツ生成、要約、セマンティック検索、自然言語のコード変換など、特定のタスクに簡単に適応できます。ユーザーは、REST API、Python SDK、または Azure OpenAI Studio の Web ベースのインターフェイスを介してサービスにアクセスできます。*

9. **[生成]** ボタンを使用して新しいプロンプトを送信し、モデルがテキストを適切に要約していることを確認します。

## モデルを使用してテキストを分類する

ここまでは、モデルを使用してテキストを要約する方法を見てきました。 しかし、Azure OpenAI の生成モデルでは、他にもさまざまな種類のタスクをサポートできます。 別の例として、"テキスト分類" を見てみましょう。**

1. **[入力候補]** ページで、**text-davinci** デプロイが選択されていることを確認し、 **[例]** の一覧で **[テキストの分類]** を選択します。

    テキストの分類のサンプル プロンプトには、ニュース記事をカテゴリの範囲のいずれかに分類する命令の形式でモデルのコンテキストが記述されます。 次に、ニュース記事のテキスト (先頭に "ニュース記事:" が付いており、末尾に "分類されたカテゴリ:" が付いている) が提供されます。** ** 適切なカテゴリを予測することで、モデルがプロンプトの最終行の "入力を補完する" ことが目的です。

2. **[生成]** ボタンを使用して、プロンプトをモデルに送信し、応答を取得します。 このモデルは、ニュース記事の適切なカテゴリを予測する必要があります。
3. 予測されるカテゴリの下に、次のテキストを追加します。

    *ニュース記事: Microsoft が Azure OpenAI サービスをリリース。Microsoft Corporation は、Azure クラウドでアプリとサービスを構築するアプリケーション開発者が OpenAI モデルを使用できるようにする Azure サービスをリリースしました。*

    *分類されたカテゴリ:*

4. **[生成]** ボタンを使用してモデルのダイアログを続行し、新しいニュース記事に適した分類を生成します。

## プロンプトとパラメーターを探索する

ここまでは、Azure OpenAI Studio で提供されている例に基づいたプロンプトを表示してきました。 別のものを試してみましょう。

1. プロンプト領域のすべてのテキストを次のテキストに置き換えます。

    *あなたは、学生のテストを作成する教師です。*

    *次のテキストに基づいて、3 つの複数選択の質問を作成してください。*

    *コンピューター ビジョン ソリューションの多くが、カメラ、ビデオ、またはイメージからの視覚入力に適用できる機械学習モデルに基づいています。*

    *\- 画像分類には、その内容に基づいて画像を分類するための機械学習モデルのトレーニングが含まれます。たとえば、交通監視ソリューションでは、画像分類モデルを使用して、タクシー、バス、自転車など、画像に含まれる車両の種類に基づいて画像を分類できます。*

    *\- 物体検出の機械学習モデルは、画像内の個々の物体を分類し、境界ボックスでその場所を識別するようにトレーニングされます。たとえば、交通監視ソリューションでは、物体検出を使用して、さまざまなクラスの車両の場所を識別できます。*

    *\- セマンティック セグメンテーションは、画像内の個々のピクセルが、それらが属する物体に従って分類される高度な機械学習手法です。たとえば、交通監視ソリューションでは、交通の画像を "マスク" レイヤーでオーバーレイして、特定の色を使用してさまざまな車両を強調表示することができます。*

2. **[パラメーター]** ペインでは、次のパラメーター値を設定します。
    - **[温度]** : 0
    - **[最大長 (トークン)]** : 500
    - **[応答前のテキスト]** : 自動生成された質問。 テストで使用する前に検証します。
3. **[生成]** ボタンを使用してプロンプトを送信し、結果を確認します。 *[応答前のテキスト]* パラメーターの値、その後に教師がコンピューター ビジョンのトピックで学生をテストするためにプロンプトで使用できる複数選択の質問で構成されている必要があります。 応答の合計は、パラメーターとして指定した最大長よりも短くする必要があります。

    使用したプロンプトとパラメーターで、次の点を確認してください。

    - プロンプトに、動作についてモデルに指示する自然言語コンテキスト情報が含まれている。 具体的には、モデルが学生向けにテストを作成する教師の役割を引き受けるように示すものです。
    - パラメーターに、応答生成にどの程度の確率的要素を含むかを制御する "温度" が含まれている。** 送信で **0** の値を使用すると、ランダム性が最小限に抑えられ、結果として安定した予測可能な応答が得られます。

4. **[再生成]** ボタンを使用して応答を再生成します。 これは、前の応答と似たものになるはずです。
5. **[温度]** パラメーターの値を **0.9** に変更し、 **[再生成]** ボタンを使用して応答を再生成します。 今回はランダム性が高いので、異なる応答が得られるはずです。 ただし、この質問では、以前に生成された応答よりも不正確な内容が含まれる可能性が高くなります。

## コード生成について探索する

デプロイした **text-davinci** モデルは、ほとんどのタスクを適切に処理できる優れた一般的なモデルです。 ただし、場合によっては、特定の種類のタスク用に最適化されたモデルを選択することをお勧めします。 たとえば、Azure OpenAI モデルを使用すると、自然言語テキストではなくコンピューター コードを生成できます。一部のモデルは、そのタスク用に最適化されています。

1. Azure OpenAI Studio で、 **[モデル]** ページを表示します。Azure OpenAI サービス リソースで使用可能なすべてのモデルが一覧表示されます。
2. **code-davinci-002** モデルを選択し、 **[モデルのデプロイ]** ボタンを使用してデプロイ名 **code-davinci** でデプロイします。
3. デプロイが完了したら、Azure OpenAI Studio で **[デプロイ]** ページを表示します。デプロイしたモデルが一覧表示されます。
4. **code-davinci** モデル デプロイを選択し、 **[プレイグラウンドで開く]** ボタンを使用してプレイグラウンドで開きます。
5. **[入力候補]** ページで、**code-davinci** デプロイが選択されていることを確認し、 **[例]** の一覧で **[Natural language to SQL] (自然言語から SQL)** を選択します。

    [Natural language to SQL] (自然言語から SQL) のサンプル プロンプトでは、データベース内のテーブルの詳細と、`SELECT` キーワードの前に必要なクエリの説明が提供されます。 モデルが `SELECT` ステートメントを入力して、要件を満たすクエリを作成できるようにすることが目的です。

6. **[生成]** ボタンを使用して、プロンプトをモデルに送信し、 SQL `SELECT` クエリで構成される応答を取得します。
7. プロンプトと応答全体を次の新しいプロンプトに置き換えます。

    *# Python 3*

    *# "Hello " と指定した文字列を印刷する関数を作成します*

    *def print_hello(s):*

8. **[生成]** ボタンを使用してプロンプトを送信し、生成されるコードを表示します。 プロンプトには、生成するプログラミング言語 (Python 3) の表示、目的の機能を説明するコメント、および関数定義の最初の部分が含まれていました。 **code-davinci** モデルは、適切な Python コードを使用して関数を完了している必要があります。

## チャット用のモデルを探索する

ChatGPT は OpenAI によって開発されたチャットボットであり、会話シナリオでさまざまな自然言語の応答を提供できます。 Azure OpenAI には、ChatGPT とそれを使用するための API によって使用されるモデルが含まれています。

1. Azure OpenAI Studio で、 **[モデル]** ページを表示します。Azure OpenAI サービス リソースで使用可能なすべてのモデルが一覧表示されます。
2. **gpt-35-turbo** モデルを選択し、 **[モデルのデプロイ]** ボタンを使用してデプロイ名 **gpt-chat** でデプロイします。
3. モデルがデプロイされたら、 **[プレイグラウンド]** セクションで **[チャット]** ページを選択し、右側のペインで **gpt-chat** モデルが選択されていることを確認します。
4. **[アシスタントのセットアップ]** セクションの **[システム メッセージ]** ボックスで、現在のテキストを次のように置き換えます。

    *このシステムは、ユーザーが AI について学習するのに役立つ AI 教師です*

5. **[システム メッセージ]** ボックスの下にある **[Add few-shot examples] (Few-shot の例を追加する)** をクリックし、指定されたボックスに次のメッセージと応答を入力します。

    ユーザー: *人工知能にはどのような種類がありますか?*

    アシスタント: *人工知能には主に次の 3 種類があります。Siri や Alexa などの仮想アシスタント、画像認識ソフトウェア、スパム フィルターなどの特定型 (弱い) AI、現在は存在しない純粋に理論上の AI である、人間と同じくらい賢くなるように設計された汎用型 (強い) AI、そして、人間よりも賢く、人間の理解を超えるタスクを実行できる AI である人工超知能です。この種類の AI も純粋に理論上のもので、まだ開発されていません。*

    > **注**: Few-shot の例は、予測される応答の種類の例をモデルに提供するために使用されます。 モデルは、例のトーンとスタイルを自分の応答に反映させようとします。

6. 変更を保存して新しいセッションを開始し、チャット システムの動作コンテキストを設定します。

7. ページの下部にあるクエリ ボックスに、次のテキストを入力します。

    *人工知能とは何ですか?*

8. **[送信]** ボタンを使用してメッセージを送信し、応答を表示します。

    > **注**: API デプロイの準備がまだできていないという応答を受け取る場合があります。 その場合は、数分待ってからもう一度やり直してください。

9. 応答を確認し、次のメッセージを送信して会話を続けます。

    *それは機械学習とどのように関連していますか?*

10. 応答を確認し、前の対話式操作のコンテキストが保持されていることを確認します ("それ" が人工知能を指していることをモデルが認識しています)。

この演習では、Azure サブスクリプションで Azure OpenAI サービスをプロビジョニングする方法と、Azure OpenAI Studio を使用してモデルをデプロイおよび探索する方法について学習しました。

開発者は、REST インターフェイスと言語固有の API を使用して、Azure OpenAI モデルを使用するアプリとサービスを作成できます。それによって、自分のアプリケーションで生成 AI モデルを活用できます。 Azure OpenAI のコーディングについては、他の演習で説明します。
