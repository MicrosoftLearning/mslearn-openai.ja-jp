---
lab:
  title: Azure OpenAI で作業を開始する
---

# Azure OpenAI Service で作業を開始する

Azure OpenAI Service は OpenAI によって開発された生成 AI モデルを Azure プラットフォームに導入します。これにより、Azure クラウド プラットフォームによって提供されるサービスのセキュリティ、スケーラビリティ、統合の恩恵を受ける強力な AI ソリューションを開発できるようになります。 この演習では、サービスを Azure リソースとしてプロビジョニングし、Azure OpenAI Studio を使用して OpenAI モデルをデプロイおよび探索することで、Azure OpenAI の使用を開始する方法について学習します。

この演習は約 **30** 分かかります。

## 開始する前に

Azure OpenAI サービスへのアクセスが承認されている Azure サブスクリプションが必要になります。

- 無料の Azure サブスクリプションにサインアップするには、[https://azure.microsoft.com/free](https://azure.microsoft.com/free) にアクセスしてください。
- Azure OpenAI Service へのアクセスを要求するには、[https://aka.ms/oaiapply](https://aka.ms/oaiapply) にアクセスしてください。

## Azure OpenAI リソースをプロビジョニングする

Azure OpenAI モデルを使用する前に、Azure サブスクリプションに Azure OpenAI リソースをプロビジョニングする必要があります。

1. [Azure portal](https://portal.azure.com) にサインインします。
2. 次の設定で **Azure OpenAI** リソースを作成します。
    - **サブスクリプション**: Azure OpenAI Service のアクセスが承認されている Azure サブスクリプション。
    - **リソース グループ**: ご自分で選択した名前を持つ新しいリソース グループを作成します。
    - **リージョン**: 使用できるリージョンを選びます。
    - **名前**: 任意の一意の名前。
    - **価格レベル**: Standard S0
3. デプロイが完了するまで待ちます。 次に、Azure portal でデプロイされた Azure OpenAI リソースに移動します。

## モデルをデプロイする

Azure OpenAI には、モデルのデプロイ、管理、探索に使用できる **Azure OpenAI Studio** という名前の Web ベースのポータルが用意されています。 Azure OpenAI Studio を使用してモデルをデプロイすることで、Azure OpenAI の探索を開始します。

1. Azure OpenAI リソースの **[概要]** ページで、 **[探索]** ボタンを使用して、新しいブラウザー タブで Azure OpenAI Studio を開きます。
2. Azure OpenAI Studio で、新しいデプロイを次の設定で作成します。
    - **モデル**: gpt-35-turbo
    - **モデル バージョン**: 既定値に自動更新
    - **デプロイ名**: my-gpt-model

> **注**: Azure OpenAI には複数のモデルが含まれており、それぞれが機能とパフォーマンスの異なるバランスに合わせて最適化されています。 この演習では、**GPT-35-Turbo** モデルを使用します。これは、自然言語とコードを要約して生成するための優れた一般的なモデルです。 Azure OpenAI で使用可能なモデルの詳細については、Azure OpenAI ドキュメントの[モデル](https://learn.microsoft.com/azure/cognitive-services/openai/concepts/models)に関する記事を参照してください。

## 入力候補のプレイグラウンドでモデルを探索する

"プレイグラウンド" は、Azure OpenAI Studio の便利なインターフェイスであり、独自のクライアント アプリケーションを開発することなく、デプロイされるモデルを実験するために使用できます。**

1. Azure OpenAI Studio の左ペインの **[プレイグラウンド]** で、 **[入力候補]** を選択します。
2. **[入力候補]** ページで、**my-gpt-model** デプロイが選択されていることを確認し、 **[例]** の一覧で **[テストの生成]** を選択します。

    テキストの要約のサンプルは、どのような応答が必要かをモデルに伝え、コンテキスト情報を含めたテキストを提供する "プロンプト" で構成されています。**

3. ページの下部の、テキストで検出された "トークン" の数をメモします。** トークンは、プロンプトの基本的な単位です。基本的には、テキスト内の単語または単語の一部です。
4. **[生成]** ボタンを使用して、プロンプトをモデルに送信し、応答を取得します。

    応答は、プロンプトの例に基づくテストで構成されます。

5. **[再生成]** ボタンを使用してプロンプトを再送信します。応答が元のものとは異なる場合があります。 生成 AI モデルは、呼び出されるたびに新しい言葉を生成できます。
6. **[コードの表示]** ボタンを使用して、クライアント アプリケーションがプロンプトの送信に使用するコードを表示します。 任意のプログラミング言語を選択できます。 プロンプトには、モデルに送信したテキストが含まれます。 要求は、Azure OpenAI Service の *Completions* API に送信されます。

## チャット プレイグラウンドを使用する

"チャット" プレイグラウンドには、GPT 3.5 以降のモデル用のチャットボット インターフェイスが用意されています。** 以前の *Completions* API ではなく *ChatCompletions* API が使用されます。

1. **[プレイグラウンド]** セクションで **[チャット]** ページを選択し、右側の構成ペインで **my-gpt-model** モデルが選択されていることを確認します。
2. **[アシスタントのセットアップ]** セクションの **[システム メッセージ]** ボックスで、現在のテキストを `AIについての学びをサポートするAI教師` のステートメントに置き換えます。

3. **[システム メッセージ]** ボックスの下にある **[Examples]** をクリックし、指定されたボックスに次のメッセージと応答を入力します。

    - **ユーザー**: `人工知能にはどのような種類があるのか？`
    - **アシスタント**: `主に3つのタイプの人工知能があります：狭い、または弱いAI（SiriやAlexaのような仮想アシスタント、画像認識ソフトウェア、スパムフィルターなど）、一般的または強いAI（人間と同じくらいの知能を持つように設計されたAI。このタイプのAIは現在存在せず、純粋に理論的なものです）、そして超越的人工知能（人間よりも知能が高く、人間の理解を超えるタスクを実行できるAI。このタイプのAIも純粋に理論的であり、まだ開発されていません）。`

    > **注**: Few-shot の例は、予測される応答の種類の例をモデルに提供するために使用されます。 モデルは、例のトーンとスタイルを自分の応答に反映させようとします。

4. 変更を保存して新しいセッションを開始し、チャット システムの動作コンテキストを設定します。
5. ページの下部にあるクエリ ボックスに、テキスト `人工知能とは何?` を入力します
6. **[送信]** ボタンを使用してメッセージを送信し、応答を表示します。

    > **注**: API デプロイの準備がまだできていないという応答を受け取る場合があります。 その場合は、数分待ってからもう一度やり直してください。

7. 応答を確認し、`それは機械学習とどう関係していますか？` のメッセージを送信して会話を続けます。
8. 応答を確認し、前の対話式操作のコンテキストが保持されていることを確認します ("それ" が人工知能を指していることをモデルが認識しています)。
9. **[コードの表示]** ボタンを使用して、対話式操作のコードを表示します。 プロンプトは、"システム" メッセージ、"ユーザー" と "アシスタント" のメッセージの Few-shot の例、そしてチャット セッション内の "ユーザー" と "アシスタント" のメッセージのシーケンスで構成されています。

## プロンプトとパラメーターを探索する

プロンプトとパラメーターを使用して、必要な応答が生成される可能性を最大限に高めることができます。

1. **[パラメーター]** ペインでは、次のパラメーター値を設定します。
    - **[温度]** : 0
    - **[最大長 (トークン)]** : 500

2. 次のメッセージを送信します

    ```
    次のテキストに基づいて、3 つの多肢選択式の質問を書いてください。
    
    ほとんどのコンピュータビジョンソリューションは、カメラ、ビデオ、または画像からの視覚的入力に適用できる機械学習モデルに基づいています。
    
    - 画像の分類は、画像の内容に基づいて画像を分類する機械学習モデルをトレーニングすることを含みます。例えば、交通監視ソリューションでは、タクシーやバス、自転車など、画像に含まれる車両の種類に基づいて画像を分類するモデルを使用するかもしれません。
    
    - 物体検出機械学習モデルは、画像内の個々の物体を分類し、境界ボックスでその位置を特定するために訓練されます。例えば、交通監視ソリューションは、異なるクラスの車両の位置を特定するために物体検出を使用するかもしれません。 
    
    - セマンティックセグメンテーションは、画像の個々のピクセルが所属するオブジェクトに従って分類される高度な機械学習技術です。例えば、交通監視ソリューションは、特定の色を使用して異なる車両を強調表示するために、交通画像に「マスク」レイヤーをオーバーレイするかもしれません。
    ```

3. 結果を確認します。教師がコンピューター ビジョンのトピックについてプロンプトで学生をテストするために使用できる複数選択の質問で構成されている必要があります。 応答の合計は、パラメーターとして指定した最大長よりも短くする必要があります。

    使用したプロンプトとパラメーターで、次の点を確認してください。

    - プロンプトでは、目的の出力が 3 つの複数選択の質問であることが具体的に示されます。
    - パラメーターに、応答生成にどの程度の確率的要素を含むかを制御する "温度" が含まれている。** 送信で **0** の値を使用すると、ランダム性が最小限に抑えられ、結果として安定した予測可能な応答が得られます。

## コード生成について探索する

自然言語による応答を生成するだけでなく、GPT モデルを使用してコードを生成することもできます。

1. **[アシスタントのセットアップ]** ペインで、 **[空の例]** テンプレートを選択してシステム メッセージをリセットします。
2. システム メッセージ `あなたはPythonの開発者です。` を入力し、変更を保存します。
3. **[チャット セッション]** ペインで、 **[チャットのクリア]** を選択してチャット履歴をクリアし、新しいセッションを開始します。
4. 次のユーザー メッセージを送信します。

    ```
    二つの数値パラメータを掛け合わせる「Multiply」という名前のPython関数を書いてください。
    ```

5. 応答を確認します。プロンプトの要件を満たすサンプルの Python コードが含まれている必要があります。

## クリーンアップ

Azure OpenAI リソースでの作業が完了したら、[Azure portal](https://portal.azure.com) 内のデプロイまたはリソース全体を必ず削除してください。
